- name: Deploy with Docker
  shell: bash
  run: |
    set -e
    TARGET_DIR="/var/www/html/smart-paddy"
    echo "üöÄ Copying files to $TARGET_DIR..."

    sudo mkdir -p "$TARGET_DIR"
    sudo rsync -avz \
      --exclude '.git' \
      --exclude 'node_modules' \
      --exclude '.next' \
      ./ "$TARGET_DIR"

    echo "üê≥ Building Docker..."
    cd "$TARGET_DIR/web"
    sudo docker compose down
    sudo docker compose up -d --build
    sudo docker image prune -f

    echo "‚úÖ Deployment Successful!"
